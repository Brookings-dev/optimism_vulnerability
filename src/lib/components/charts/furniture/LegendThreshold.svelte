<!--
  @component
  Generates a legend for a chart that uses an threshold scale.
 -->
<script>
	import colors from '$lib/utils/colors.json';
	import { selectedSecond } from '$lib/stores.js';
	import { format } from 'd3';

	/** @type {Array} colors=['#000000', '#222222'] - the corresponding colors fo the legend  */
	export let colorScale;

	/** @type {String} title={'Percent of searches'} - a title for the legend  */
	export let title;

	export let scales = ['no data', 1, 2, 3, 4, 5];

	let formatValue = (d) =>
		$selectedSecond == 'income'
			? format(',')(format('.0f')(Number(d)))
			: format(',')(format('.1f')(Number(d)));
</script>

<div class="m-auto w-full">
	{#if title}
		<p class="my-0 mb-2 font-sans text-{colors.navy.DEFAULT} font-bold text-sm text-center">
			{@html title}
		</p>
	{/if}
	<div class="grid grid-cols-6 justify-items-center text-left gap-0">
		{#each colorScale as color, i}
			<div class="w-full h-[10px] mb-2" style="background: {colorScale[i]}" />
		{/each}
		<p class="font-sans justify-self-center text-[11px] text-black max-w-[50px] leading-tight">
			no data
		</p>
		{#each scales as scale, i}
			<p
				class="font-sans justify-self-center text-[11px] text-black sm:max-w-[50px] mx-2 leading-tight"
			>
				{isNaN(scales[i - 1])
					? 0 + ' - ' + formatValue(scale)
					: formatValue(scales[i - 1]) + ' - ' + formatValue(scale)}
			</p>
		{/each}
	</div>
</div>
